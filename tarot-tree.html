<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>ZingSoft Demo</title>
  <script nonce="undefined" src="https://cdn.zingchart.com/zingchart.min.js"></script>
  <script nonce="undefined">
    zingchart.MODULESDIR = "https://cdn.zingchart.com/modules/";
  </script>

  <script nonce="undefined" src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous">
  </script>

  <script nonce="undefined" src='https://s3-us-west-2.amazonaws.com/s.cdpn.io/374756/simpsons.js'></script>
  <style>
    html,
    body {
      height: 100%;
      width: 100%;
      margin: 0;
      padding: 0;
    }

    #myChart {
      height: 100%;
      width: 100%;
      min-height: 150px;
    }

    .zc-ref {
      display: none;
    }
  </style>
</head>

<body>
<div id="myChart"></div>
<script>
  const someImage = '';
  const major00 = [
    'https://upload.wikimedia.org/wikipedia/commons/5/58/Tarot_Belgijski_-_A22_-_G%C5%82upiec.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/thumb/d/de/RWS_Tarot_01_Magician.jpg/340px-RWS_Tarot_01_Magician.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/8/88/RWS_Tarot_02_High_Priestess.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/d/d2/RWS_Tarot_03_Empress.jpg',
  ]
</script>
<script>
  const imgArr = major00;
  const createNode = ( name, keyword, img ) =>
  {
    return {
      name: name,
      keyword: keyword,
      img: img,
      children: []
    }
  }
</script>

<!--    https://youtu.be/HVFak8SS_CM?t=28-->
<script>

  const impulsive = createNode( 'Impulsive', 'Impulsive', someImage )
  const wildCard = createNode( 'Wild Card', 'Wild Card', someImage )
  const careFree = createNode( 'Care Free', 'Care Free', someImage )
  const aimless = createNode( 'Aimless', 'Aimless', someImage )
  {
    const detached = createNode( 'Detached', 'Detached', someImage )
    const reluctance = createNode( 'Reluctance', 'Reluctance', someImage )
    const uncaring = createNode( 'Uncaring', 'Uncaring', someImage )
    const unpredictable = createNode( 'Unpredictable', 'Unpredictable', someImage )
    impulsive.children.push( {detached: detached} );
    impulsive.children.push( {reluctance: reluctance} );
    impulsive.children.push( {uncaring: uncaring} );
    impulsive.children.push( {unpredictable: unpredictable} );

    const individuality = createNode( 'Individuality', 'Individuality', someImage )
    const variables = createNode( 'Variables', 'Variables', someImage )
    const nonConforming = createNode( 'Non-conforming', 'Non-conforming', someImage )
    const creative = createNode( 'Creative', 'Creative', someImage )

    wildCard.children.push({individuality: individuality})
    wildCard.children.push({variables: variables})
    wildCard.children.push({nonConforming: nonConforming})
    wildCard.children.push({creative: creative})

    const freeSpirit = createNode( 'Free Spirit', 'Free Spirit', someImage )
    const dreamer = createNode( 'Dreamer', 'Dreamer', someImage )
    const hopeful = createNode( 'Hopeful', 'Hopeful', someImage )
    const unrestricted = createNode( 'Unrestricted', 'Unrestricted', someImage )

    careFree.children.push({freeSpirit:freeSpirit})
    careFree.children.push({dreamer:dreamer})
    careFree.children.push({hopeful:hopeful})
    careFree.children.push({unrestricted:unrestricted})

    const spontaneous = createNode( 'Spontaneous', 'Spontaneous', someImage )
    const innocence = createNode( 'Innocence', 'Innocence', someImage )
    const blindTrust = createNode( 'Blind Trust', 'Blind Trust', someImage )
    const liberation = createNode( 'Liberation', 'Liberation', someImage )
    aimless.children.push({spontaneous:spontaneous})
    aimless.children.push({innocence:innocence})
    aimless.children.push({blindTrust:blindTrust})
    aimless.children.push({liberation:liberation})
  }



  const theFool = createNode( 'The Fool', 'Believing', imgArr[0] );
  {
    theFool.children.push( {impulsive:impulsive} );
    theFool.children.push( {wildCard:wildCard} );
    theFool.children.push( {careFree:careFree} );
    theFool.children.push( {aimless:aimless} );
  }

</script>

<!--    https://youtu.be/HVFak8SS_CM?t=28-->
<script>
  const confidence = createNode('Confidence', 'Confidence', someImage)
  {
    const swiftAction = createNode('Swift Action', 'Swift Action', someImage)
    const support = createNode('Support', 'Support', someImage)
    const influence = createNode('Influence', 'Influence', someImage)
    const empowering = createNode('Empowering', 'Empowering', someImage)
    confidence.children.push({swiftAction: swiftAction});
    confidence.children.push({support: support});
    confidence.children.push({influence: influence});
    confidence.children.push({empowering: empowering});
  }

  const theMagician = createNode( 'The Magician', 'Awareness', imgArr[1] );
  {
    theMagician.children.push( {confidence:confidence} );
  }

</script>

<script>
  const theHighPriestess = createNode( 'The High Priestess', 'Mystery', imgArr[2] );
</script>

<script>
  const theEmpress = createNode( 'The Empress', 'Creativity', imgArr[3] );
</script>

<script>
  const majorArcana = { root: createNode('Major Arcana', 'Major Arcana', 'https://cdn.pixabay.com/photo/2016/11/28/23/55/pentagram-1866328__480.png') };
  majorArcana.root.children.push( {theFool:theFool} );
  majorArcana.root.children.push( {theMagician:theMagician} );
  majorArcana.root.children.push( {theHighPriestess:theHighPriestess} );
  majorArcana.root.children.push( {theEmpress:theEmpress} );
</script>
<script>

  const create_Node = ( node ) =>
  {
    node = node[Object.keys(node)[0]];

    const n = {
      type: 'node',
      id: node.name,
      text: node.name,
      dataFullName: node.keyword,
      style: {
        'background-fit': 'xy',
      },
      "url": "http://www.google.com/#q=%data-band",
      "target": "_blank",
      "background-color": "#0CF"
    };
    if ( node.img )
    {
      n.style.backgroundImage = node.img
    }
    // console.log( node );
    return n;
  }
  const create_Link = ( parent, child ) =>
  {
    parent = parent[Object.keys(parent)[0]];
    child = child[Object.keys(child)[0]];
    // console.log( 'parent', parent, 'child', child );
    return {
      type: 'link',
      source: parent.name,
      target: child.name
    };
  }

  const treeNodes = [];
  const treeLinks = [];

  const traverse = ( parent, obj, level ) =>
  {
    if ( level > 20 )
      return;

    const node = create_Node( obj );
    treeNodes.push( node );
    if ( parent )
    {
      const link = create_Link( parent, obj );
      treeLinks.push( link );
    }
    Object.keys(obj).map( k => {
      const o = obj[k];
      // console.log( o.name, o.img );
      for ( let i = 0; i < o.children.length; i++ )
      {
        traverse( obj, o.children[i], (level+1) );
      }
    });
  }

  traverse( null, majorArcana, 0 );

  let treeData = [];
  treeData = treeData.concat( treeNodes );
  treeData = treeData.concat( treeLinks );
  // treeData.push( ...treeLinks );
  // treeData.map( t => console.log( t ) );

</script>

<script>
  const major = {
    theFool: {
      img: 'https://upload.wikimedia.org/wikipedia/commons/thumb/9/90/RWS_Tarot_00_Fool.jpg/340px-RWS_Tarot_00_Fool.jpg'
    }

  }
</script>
<script>
  ZC.LICENSE = ["569d52cefae586f634c54f86dc99e6a9", "b55b025e438fa8a98e32482b5f768ff5"];


  let chartConfig = {
    type: 'tree',
    plot: {},
    plotarea: {
      margin: 40,
      backgroundImage: 'https://cdn.pixabay.com/photo/2017/12/29/10/44/magician-3047235__480.jpg',
      backgroundFit: 'xy',
      backgroundRepeat: false,
    },
    options: {
      aspect: 'graph',
      springLength: 75,
      attractionConstant: 0.8,
      repulsionConstant: 4000,
      repulsionDistanceFactor: 20,
      node: {
        size: 24,
        borderWidth: 3,
        borderColor: 'white',
        backgroundColor: '#fff',
        backgroundRepeat: 'no-repeat',
        backgroundScale: 0.75,
        label: {
          color: 'white',
          fontWeight: 'bold',
          offsetY: 35
        },
        tooltip: {
          text: '%data-full-name',
          visible: true,
        }
      },
      'node[cls-fam]': {
        size: 12,
        borderWidth: 2,
        borderColor: '#000',
        backgroundColor: 'white',
        label: {
          visible: false
        }
      },
      link: {
        lineWidth: 3,
        lineColor: 'white'
      }
    },
    // series: chartData
    series: treeData
  };



  zingchart.bind('myChart', 'node_click', function(e) {
    // zcdocs.demos.dump('node_click', e);
    console.log( e );
  });
  zingchart.bind('myChart', 'node_mousedown', function(e) {
    // zcdocs.demos.dump('node_mousedown', e);
    console.log( e );
  });
  zingchart.bind('myChart', 'node_mouseup', function(e) {
    // zcdocs.demos.dump('node_mouseup', e);
    console.log( e );
  });
  zingchart.render({
    id: 'myChart',
    width: 1000,
    height: 800,
    output: 'canvas',
    data: chartConfig,
    events: {
      node_click: function(p) {
        console.log(p.value);

      }
    }
  });

  zingchart.bind("myChart","node_click",function(p){
    console.log( 'node_click', p );
  });

  // Hides callout label when click is not on a node
  zingchart.bind("myChart","click",function(p){
    console.log( 'click', p );

  });

</script>
</body>

</html>
